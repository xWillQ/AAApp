/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn how to create Gradle builds at https://guides.gradle.org/creating-new-gradle-builds
 */

plugins {
    id 'org.jetbrains.kotlin.jvm' version '1.3.71'
    id 'com.github.johnrengelman.shadow' version '5.2.0'
    id 'jacoco'
    //id 'org.jlleitschuh.gradle.ktlint' version '9.2.1'
    id 'org.jmailen.kotlinter' version '2.3.2'
}

repositories {
    mavenCentral()
    maven { url "https://kotlin.bintray.com/kotlinx" }
    jcenter()
}

dependencies {

    implementation "org.jetbrains.kotlin:kotlin-stdlib-jdk8"

    implementation "org.flywaydb:flyway-core:6.3.3"
    implementation "org.jetbrains.kotlinx:kotlinx-cli:0.2.1"
    implementation "org.apache.logging.log4j:log4j-api:2.13.1"
    implementation "org.apache.logging.log4j:log4j-core:2.13.1"
    implementation "com.h2database:h2:1.4.200"

    testImplementation "org.jetbrains.kotlin:kotlin-test"
    testImplementation "org.spekframework.spek2:spek-dsl-jvm:latest.release"
    testRuntimeOnly "org.spekframework.spek2:spek-runner-junit5:latest.release"
    testRuntimeOnly "org.jetbrains.kotlin:kotlin-reflect:latest.release"

    testImplementation 'org.mockito:mockito-inline:latest.release'
    testImplementation 'org.mockito:mockito-core:latest.release'
}

jar {
    manifest {
        attributes 'Main-Class': 'com.kafedra.aaapp.MainKt'
        attributes 'Multi-Release': 'true'
    }
}

shadowJar {
   classifier = ''
   destinationDir = file("$rootDir")
}

test {
    useJUnitPlatform {
        includeEngines 'spek2'
    }
}

jacocoTestReport {
    reports {
        xml.enabled true
        html.enabled true
    }
}

kotlinter {
    reporters = ['html']
}